/////////////////////////////////////////////////////////////////
// Author : Caroline Collard (IPHC) - first commit : april 2011
// README_btagNtupReader
////////////////////////////////////////////////////////////////


1) Create the histos and store them in root files
-------------------------------------------------

> ./compile
> ./btagNtupReader

First, you compile the code
Second, you run it

IMPORTANT : you have to specify  in the "run" function of btagNtupReader.C

	1. where the data/MC are : like
btagNtupReader yt(2, "/opt/sbg/data/data1/cms/ccollard/files/btagCommNtuple/V3/bTagCommissioning_30_03_11/Met_all_2011/*.root");   
	where the "2" stands for version of the commissioning ntuples --> will imply which branchs are read (see btagNtupReader.h, quite 
	similar to what you get with a MakeClass() in root). 
	"/opt/..../*root" indicates the complete path of your ntuples.

        2. what is the type of the root file :
yt.Loop(0, weight);
	where "0" means DATA and "1" means MC, 
	"weight" is the weight to use to normalize the different MC with respect to each other. 

	3. the ouptut root file name and directory :
system("mv  jambo_btag20_mu/histoFile.root jambo_btag20_mu/histo_minibtag2011.root")
	the first one "jambo_btag20_mu/histoFile.root" is defined in the "Loop" function, 
	the last one "jambo_btag20_mu/histo_minibtag2011.root" is the final destination.

IMPORTANT : you have to specify  at the bginning of the file btagNtupReader.C  "TO BE DEFINED FIRST !"
	4. if you run on Jet or on MetBtag --> Run_on_Jet and Run_on_Btag (true = yes)
	5. the trigger you want to use --> my_trigger_path
	6. the PT cut for jets --> cutJetPt
	7. the PT cut for muons --> cutMuonPt (applied only in the case Run_on_Btag==true)

IF YOU WANT TO ADD AN HISTO SEE BELOW : 3)


2) Display the histos in root and save png files
------------------------------------------------

> root -l  displayPlots.C

This will load "LoadDisplayRootPlot.C" which provides the template 
for the canvas, and make the plots for all the variables put in displayPlots.C
with the command :
PlotStack(TString selection, int date, bool down=false, bool logy=false, bool mu=false)
where selection  is the name of the histogram you want to plot,
      date is the year of the data you are looking for,
      down determines the way of the stack histo (b,c,udgs or udsg,c,b),
      logy =1 means Logy option,
      mu = false means jet dataset and mu = true is for btagmet datset
--> example :  PlotStack("npv",2011, 0, 0,1);

IMPORTANT : Inside LoadDisplayRootPlot.C, you have to specify 
the name of the different rootfiles and the directory where they are.


3) How to add a new histo?
--------------------------
- Go in the  "Loop" function of btagNtupReader.C

- Define your histo following the template :
AddHisto(string name_of_histo, int j, string title, string xaxis, const int& nbins, const float& min, const float& max)
	example: " AddHisto(HistoBtag, "all_jetpt",       j,"PT of all jets",80,0.,400.);"
	the "j" index is used for MC samples to produce global histogram, b contribution, c contribution, light 
	contribution and gluon splitting into b.  If you need to keep this quark content info, put your new line
	in the "j" loop. Otherwise, put it after the loop.
	-->> Search for the comment "ADD HERE NEW HISTO" in  btagNtupReader.C to help you.
	There is also a template for 2D histo.

- Fill your histo
	example : " HistoBtag[0+j*nhisto_to_clone]->Fill(jetPt[i], weight); "                    inside the "j" loop for 1D histo
	example : " HistoBtag[jmax*nhisto_to_clone+7]->Fill(numberOfPrimaryVertices,weight); "   outside the "j" loop for 1D histo
	The tricky thing is to know which index to use!
	--->  THE RULE is to increment the index of histo defined just before yours.
        -->> Search for the comment "FILL HERE YOUR NEW HISTO" in  btagNtupReader.C to help you.


example of code : inside "j" loop
...
   // last histo in the definition part
        ddHisto(HistoBtag, "npv3_nsv0_3tr",              j,"# of secondary vertices (>=3tr) (#PV:>7)",              5,0,5); //150
   // my new histo 
	AddHisto(HistoBtag, "new_histo", j,"Test Caro",50,0.,1.);
....
   // filling part for last histo :
        HistoBtag[150+j*nhisto_to_clone]->Fill(nnsv3tr, weight);
   // my new histo
        float caro_new_info=0.6;
        HistoBtag[151+j*nhisto_to_clone]->Fill(caro_new_info, weight); // the "150" of "nnsv3tr" becomes here a "150" for "new_histo"



other example of code :  outside "j" loop
...
   // last histo :
   AddHisto(HistoBtag, "npu_no_scaled",  0,"numberOfPUVertices",50,-0.5,49.5);
   // my new histo  
        AddHisto(HistoBtag, "another_new_histo", 0,"Test Caro 2",50,0.,1.);
....
   // last histo :
        HistoBtag[jmax*nhisto_to_clone+10]->Fill(numberOfPUVertices,weightsave);
   // my new histo
       // FILL HERE YOUR NEW HISTO outside "j" loop
       // example :
        float caro_test_2=0.2;
        HistoBtag[jmax*nhisto_to_clone+11]->Fill(caro_test_2, weight);   // increase the "10" of "npu" histo into a "11"



